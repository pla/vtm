Parts of the code is from "Train Log" and "LTN Manager"
